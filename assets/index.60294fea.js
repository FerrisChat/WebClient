var le=Object.defineProperty;var k=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var I=(n,e,a)=>e in n?le(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a,$=(n,e)=>{for(var a in e||(e={}))j.call(e,a)&&I(n,a,e[a]);if(k)for(var a of k(e))H.call(e,a)&&I(n,a,e[a]);return n};var T=(n,e)=>{var a={};for(var s in n)j.call(n,s)&&e.indexOf(s)<0&&(a[s]=n[s]);if(n!=null&&k)for(var s of k(n))e.indexOf(s)<0&&H.call(n,s)&&(a[s]=n[s]);return a};var o=(n,e,a)=>(I(n,typeof e!="symbol"?e+"":e,a),a);import{a as p,R as t,u as g,L as b,b as v,r as x,M as K,m as G,l as J,p as ce,B as U,c as z,d as u,N as P,e as M}from"./vendor.ec9f9edf.js";const me=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function a(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=a(r);fetch(r.href,i)}};me();const A="https://api.ferris.chat/v0";class L{constructor({email:e,password:a,token:s}={}){o(this,"token");o(this,"_authenticatePromise");s?this.token=s:e&&a&&(this._authenticatePromise=this.authenticate(e,a).then(r=>(this.token=r,p.set("token",r),r)))}async authenticate(e,a){console.info("Authenticating with credentials...");const s=await fetch(A+"/auth",{method:"POST",headers:{Email:e,Password:a}});s.status>299&&(console.error(`Could not log in with given credentials. ${s.status} ${s.statusText}`),p.remove("token"),window.location.pathname="/login");const r=await s.json();return console.info("Successfully logged in."),r.token}async register(e,a,s){console.info("Registering new account...");const r=await fetch(A+"/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:a,password:s})});if(r.status>299)throw console.error(`Could not register account. ${r.status} ${r.statusText}`),new Error;return this.token=await this.authenticate(a,s),await r.json()}async request(e,a,{headers:s={},params:r,body:i,json:l}={}){this.token&&(s.Authorization=this.token),l&&(s["Content-Type"]="application/json",i=JSON.stringify(l));const d=r?"?"+new URLSearchParams(r).toString():"",m=await fetch(A+a+d,{method:e,headers:s,body:i});if(m.status==401&&(console.error("Token invalided, going back to login..."),p.remove("token"),window.location.pathname="/login"),!m.ok)throw console.error(`Received ${m.status}: ${m.statusText} when requesting to ${a}`),new Error;const w=await m.text();return console.debug(`Route ${a} responded with ${m.status}: ${m.statusText}. Data: ${w}`),m.headers.get("Content-Type")==="application/json"?JSON.parse(w):w}}var N="/assets/avatar_default.6570d95c.png";const B={IdentifyAccepted(n,{user:e}){if(!n._identified){n._identified=!0;const{api:a}=n;a.user=e,a.user.avatar=N,a.guilds=e.guilds,a._readyPromiseResolver()}},MessageCreate({api:n},{message:e}){e.author.avatar=N;let a;if(e.nonce&&(a=n.nonces.get(e.nonce))){for(let r of Object.keys(e))a[r]=e[r];a.__status__="sent",n.nonces.delete(e.nonce),window.updateChat();return}const s=e.channel_id_string;n.messages.has(s)||n.messages.set(s,[]),n.messages.get(s).push(e),n.unreadChannels.push(s)},MessageDelete({api:n},{message:e}){const a=n.messages.get(e.channel_id_string),s=a.findIndex(r=>r.id_string===e.id_string);s&&a.splice(s,1),window.updateChat()},MemberCreate({api:n},{member:e}){var r;const a=(r=n.guilds)==null?void 0:r.find(i=>i.id_string===e.guild_id_string);!a||!(a==null?void 0:a.channels[0])||(a.members.push(e),window.updateMembers())}};class de{constructor(e){o(this,"api");o(this,"ws");o(this,"url");o(this,"mustKeepAlive");o(this,"_keepAlive");o(this,"_keepAliveListener");o(this,"_identified");this.api=e,this.mustKeepAlive=!1,this._identified=!1}get rest(){return this.api.rest}async fetchWebSocketURL(){return(await this.rest.request("GET","/ws/info")).url}parseMessage(e){var r;console.log(e);const a=JSON.parse(e.data),s=a.c;s&&((r=B[s])==null||r.call(B,this,a.d))}async connect(){this.url||(this.url=await this.fetchWebSocketURL()),this.mustKeepAlive=!0,this.clear(),this.ws=new WebSocket(this.url),this.ws.onmessage=this.parseMessage.bind(this),this.ws.onopen=this.identify.bind(this),this.ws.onerror=e=>{e.eventPhase>1&&this.mustKeepAlive&&this.connect()},this.ws.onclose=()=>{this.clear(),this.mustKeepAlive&&this.connect()},this._keepAlive=setInterval(this.sendHeartbeat.bind(this),45e3)}clear(){clearInterval(this._keepAlive),clearTimeout(this._keepAliveListener)}close(){var e;this.mustKeepAlive=!1,this.clear(),(e=this.ws)==null||e.close()}identify(){this.sendJSON({c:"Identify",d:{token:this.api.token,intents:0}})}sendHeartbeat(){this.sendJSON({c:"Ping"})}sendJSON(e){this.ws.send(JSON.stringify(e))}}class D{constructor({rest:e,ws:a}={}){o(this,"rest");o(this,"ws");o(this,"user");o(this,"guilds");o(this,"messages");o(this,"nonces");o(this,"loadedChannels");o(this,"unreadChannels");o(this,"ongoingPromise");o(this,"_readyPromise");o(this,"_readyPromiseResolver");this.rest=e,this.ws=a||new de(this),this.wait().then(s=>s.ws.connect()),window._resolver(this),this._readyPromise=new Promise(s=>this._readyPromiseResolver=s),this.messages=new Map,this.nonces=new Map,this.loadedChannels=[],this.unreadChannels=[]}static fromLogin({email:e,password:a}={}){return new this({rest:new L({email:e,password:a})})}static fromRegistration({username:e,email:a,password:s}){const r=new L,i=new this({rest:r});return i.ongoingPromise=r.register(e,a,s),i}static fromToken(e){return new this({rest:new L({token:e})})}async wait(){var e;return await((e=this.rest)==null?void 0:e._authenticatePromise),await this.ongoingPromise,this}async waitForReady(){return await this._readyPromise,this}get userId(){var e;return(e=this.user)==null?void 0:e.id_string}get token(){var e;return(e=this.rest)==null?void 0:e.token}}class W extends t.Component{constructor(e){super(e);this.onKeyDown=this.onKeyDown.bind(this)}onKeyDown(e){e.key==="Enter"&&this.props.onSubmit(0)}render(){return t.createElement("div",{className:"auth-form-container"},t.createElement("div",{className:"auth-form"},t.createElement("div",{className:"auth-form-contents"},t.createElement("h1",null,this.props.title),t.createElement("form",{className:"auth-form-fields",onKeyDown:this.onKeyDown},this.props.children),t.createElement("div",{className:"auth-form-submit",onClick:this.props.onSubmit},this.props.button))))}}function y(s){var r=s,{id:n,label:e}=r,a=T(r,["id","label"]);return n="auth-form-field__"+n,t.createElement("div",{className:"auth-form-field"},t.createElement("label",{htmlFor:n},e),t.createElement("input",$({id:n},a)))}class ue extends t.Component{constructor(e){super(e);this.onSubmit=this.onSubmit.bind(this)}onSubmit(){window.startApp(),window.api=D.fromLogin({email:document.getElementById("auth-form-field__email").value,password:document.getElementById("auth-form-field__password").value})}render(){return t.createElement(W,{title:"Login to FerrisChat",button:"Log In",onSubmit:this.onSubmit},t.createElement(y,{id:"email",label:"Email",required:!0}),t.createElement(y,{id:"password",label:"Password",type:"password",required:!0}),t.createElement("div",{className:"auth-switch-type"},"Don't have an account? ",t.createElement("a",{href:"/register"},"Register")))}}class he extends t.Component{constructor(e){super(e);this.onSubmit=this.onSubmit.bind(this)}onSubmit(){window.startApp(),window.api=D.fromRegistration({username:document.getElementById("auth-form-field__username").value,email:document.getElementById("auth-form-field__email").value,password:document.getElementById("auth-form-field__password").value})}render(){return t.createElement(W,{title:"Register",button:"Sign Up",onSubmit:this.onSubmit},t.createElement(y,{id:"username",label:"Username",maxLength:"32",required:!0}),t.createElement(y,{id:"email",label:"Email",required:!0}),t.createElement(y,{id:"password",label:"Password",type:"password",required:!0}),t.createElement("div",{className:"auth-switch-type"},"Already have an account? ",t.createElement("a",{href:"/login"},"Login")))}}var pe="/assets/server_default.bb4186c5.jpg";function ge({id:n,name:e,iconUrl:a=pe}){const s=g().guildId==n?"guild-select-guild active":"guild-select-guild";return t.createElement(b,{className:s,to:`/channels/${n}`,"data-guild-id":n,"data-guild-name":e},t.createElement("img",{src:a,alt:"server avatar"}))}var h;(function(n){n.primary="primary",n.secondary="secondary",n.success="success",n.danger="danger"})(h||(h={}));function f(i){var l=i,{style:n,label:e,link:a,onClick:s}=l,r=T(l,["style","label","link","onClick"]);return t.createElement("button",$({className:`specialized ${n}`,onClick:s||(a?()=>v()(a):void 0)},r),e)}var fe="/assets/new_guild.37c1e9c3.svg";function Ee(){let[n,e]=x.exports.useState(!1),[a,s]=x.exports.useState(t.createElement(t.Fragment,null));return t.createElement(t.Fragment,null,t.createElement(K,{className:"new-guild-modal",isOpen:n,onAfterOpen:()=>s(t.createElement(t.Fragment,null,t.createElement("h1",null,"New Server"),t.createElement("div",{className:"new-guild-modal-buttons"},t.createElement(f,{style:h.primary,label:"Join Server",onClick:()=>{s(t.createElement(t.Fragment,null,t.createElement("h1",null,"Join a Server"),t.createElement("div",{className:"join-guild-input"},t.createElement("label",{htmlFor:"guild-invite"},"Server Invite"),t.createElement("input",{name:"guild-invite",id:"guild-invite__box",type:"text",placeholder:"Invite Code"})),t.createElement("div",{className:"join-guild-button-container"},t.createElement(f,{style:h.success,label:"Join Server",onClick:()=>{const r=document.querySelector("#guild-invite__box"),i=r.value;if(!/^((https?:\/\/)?(app\.)?ferris\.(chat|sh)\/invite\/?)?[a-zA-Z0-9]{3,18}\/?$/g.test(i)){r.style.border="2px solid red";return}r.disabled=!0,r.style.border="none";const l=Array.from(i.matchAll(/[a-zA-Z0-9]{3,10}/g),d=>d[0]).at(-1);window.api.rest.request("POST",`/invites/${l}`,{json:{}}).then(()=>{window.location.pathname="/home"}).catch(()=>{r.style.border="2px solid red",r.disabled=!1})}}))))}}),t.createElement(f,{style:h.success,label:"Create Server",onClick:()=>{s(t.createElement(t.Fragment,null,t.createElement("h1",null,"Create a Server"),t.createElement("div",{className:"create-guild-input"},t.createElement("label",{htmlFor:"guild-name"},"Server Name"),t.createElement("input",{name:"guild-name",id:"guild-name__box",type:"text",placeholder:"My Cool Server",minLength:1,maxLength:32})),t.createElement("div",{className:"create-guild-button-container"},t.createElement(f,{style:h.success,label:"Create Server",onClick:()=>{const r=document.querySelector("#guild-name__box"),l={name:r.value};r.disabled=!0,window.api.rest.request("POST","/guilds",{json:l}).then(({id_string:d})=>{window.location.pathname=`/channels/${d}`}).catch(()=>{r.style.border="2px solid red",r.disabled=!1})}}))))}})))),onRequestClose:()=>e(!1)},a),t.createElement("div",{className:"guild-select-guild",onClick:()=>e(!0)},t.createElement("img",{src:fe,alt:"new guild"})))}function Y(){return t.createElement("div",{className:"guild-select"},t.createElement("div",{className:"guild-select-guilds"},window.api.guilds.map(n=>t.createElement(ge,{id:n.id_string,key:n.id_string,name:n.name})),t.createElement(Ee,null)))}var we="/assets/settings_gear.f6831c15.png";function V(){return t.createElement(b,{to:"/settings",className:"settings-link"},t.createElement("img",{src:we}))}function be({children:n}){return t.createElement("div",{className:"app-content"},t.createElement(Y,null),t.createElement(V,null),t.createElement("div",{className:"main"},n))}function ve(){var n;return t.createElement(be,null,t.createElement("div",{className:"generic-message"},t.createElement("h1",null,"Hello, ",t.createElement("b",null,(n=window.api.user)==null?void 0:n.name),"!"),t.createElement("p",null,"You are in ",window.api.guilds.length," guild",window.api.guilds.length!==1?"s":"",".")))}function ye({id:n,name:e}){const{guildId:a,channelId:s}=g(),r=s==n?"channel-select-channel active":"channel-select-channel";return t.createElement(b,{className:r,to:`/channels/${a}/${n}`,"data-channel-id":n,"data-channel-name":e},"#",e)}function _e(){const{guildId:n,channelId:e}=g(),a=e==null?"channel-select-channel active":"channel-select-channel";return t.createElement(b,{className:a,to:`/channels/${n}`},"Home")}function ke(){var a;const{guildId:n}=g(),e=window.api.guilds.find(s=>s.id_string==n);return e||v()("/home"),t.createElement("div",{className:"channel-select-container"},t.createElement("div",{className:"channel-select"},t.createElement("div",{className:"guild-name"},e.name),t.createElement("div",{className:"channel-select-name"},"Channels (",e.channels?e.channels.length:NaN,")",t.createElement("hr",null)),t.createElement("div",{className:"channel-select-channels"},t.createElement(_e,null),(a=e.channels)==null?void 0:a.map(s=>t.createElement(ye,{id:s.id_string,key:s.id_string,name:s.name})))))}function Ne(){const[n,e]=x.exports.useState(0);return()=>e(a=>++a)}function Se({id:n,name:e,avatar:a}){return t.createElement("div",{className:"members-member","data-user-id":n},t.createElement("div",{className:"members-member-avatar"},t.createElement("img",{src:a||N})),t.createElement("div",{className:"members-member-content"},e))}function Ce(){const{guildId:n}=g(),e=window.api.guilds.find(a=>a.id_string==n);return e||v()("/home"),window.updateMembers=Ne(),t.createElement("div",{className:"members-container"},t.createElement("div",{className:"member-heading-name"},"Members (",e.members?e.members.length:NaN,")",t.createElement("hr",null)),t.createElement("div",{className:"members"},(e.members||[]).map(({user:a})=>t.createElement(Se,{id:a.id_string,name:a.name,avatar:a.avatar,key:a.id_string}))))}function X({children:n}){return t.createElement("div",{className:"app-content"},t.createElement(Y,null),t.createElement(V,null),t.createElement(ke,null),t.createElement("div",{className:"main"},n),t.createElement(Ce,null))}const Z={breaks:!0,linkify:!0,highlight(n,e){try{return(e?J.highlight(n,{language:e,ignoreIllegals:!0}):J.highlightAuto(n)).value}catch{return`<code class='hljs'>${n}</code>`}}},S=G(Z),_=G(Z),E=_.renderer.rules=S.renderer.rules;E.strong_open=E.strong_close=(n,e,a,s,r)=>{let i=n[e];return i.markup==="__"&&(i.tag="u"),r.renderToken(n,e,a)};E.code_inline=(n,e,a)=>{var m,w;const s=n[e],r=n[++e];let i;if(r&&r.type==="text"){const C=/^{:?\.([^}]+)}/.exec(r.content);C&&(i=C[1],r.content=r.content.slice(C[0].length))}const l=(w=(m=S.options).highlight)==null?void 0:w.call(m,s.content,i,void 0);return`<code${i?` class="${a.langPrefix}${S.utils.escapeHtml(i)}"`:""}>${l}</code>`};function Q(n){if(!!n)return(...e)=>n(...e).replace('<code class="','<code class="hljs ').replace("<code>",'<code class="hljs">')}E.fence=Q(E.fence);E.code_block=Q(E.code_block);const Ie=_.renderer.renderToken.bind(_.renderer);_.renderer.renderToken=((n,e,a)=>{var i;const s=n[e];if(s.hidden)return"";const r=Ie(n,e,a);return s.markup?`
        <span class='md-fragment'>${s.markup}</span>
        ${r}
        <span class='md-fragment'>${(i=n[++e])==null?void 0:i.markup}</span>
    `:r}).bind(_.renderer);function $e({children:n,coordinates:[e,a]}){return t.createElement("div",{className:"context-menu",style:{left:e,top:a}},t.createElement("div",{className:"context-menu-items"},n))}function O({content:n,icon:e,onClick:a,disabled:s=!1}){const r=s?"context-menu-button":"context-menu-button clickable";return t.createElement("div",{className:r,onClick:a},e?t.createElement("img",{src:e}):void 0,t.createElement("span",null,n))}var Te="/assets/copy.39c777d0.png",xe="/assets/link.6e423026.svg",Pe="/assets/trash.f43b8642.svg";const ee=15778368e5,te=BigInt(64);function Me(n){return typeof n=="string"&&(n=BigInt(n)),new Date(Number(n>>te)+ee)}function Ae(n){let e=n||Date.now();return e instanceof Date&&(e=e.getTime()),BigInt(e-ee)<<te}function F(n,e){return n.getDate()===e.getDate()&&n.getMonth()===e.getMonth()&&n.getFullYear()===e.getFullYear()}function Le(n){const e=Date.now();let a;return F(n,new Date(e))?a="Today":F(n,new Date(e-86400))?a="Yesterday":F(n,new Date(e+86400))?a="Tomorrow":a=n.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),a+` at ${n.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`}function ne(n){if(window.clipboardData&&window.clipboardData.setData)return window.clipboardData.setData("Text",n);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var e=document.createElement("textarea");e.textContent=n,e.style.position="fixed",document.body.appendChild(e),e.select();try{return document.execCommand("copy")}catch(a){return console.warn("Copy to clipboard failed.",a),!1}finally{document.body.removeChild(e)}}}function Be({message:n,coordinates:e}){const{guildId:a,channelId:s}=g();return t.createElement($e,{coordinates:e},t.createElement(O,{content:"Delete Message",icon:Pe,disabled:n.author_id_string!==window.api.userId,onClick:r=>window.api.rest.request("DELETE",`/channels/${n.channel_id_string}/messages/${n.id_string}`)}),t.createElement(O,{content:"Copy Message Content",icon:Te,onClick:r=>ne(n.content)}),t.createElement(O,{content:"Copy Message Link",icon:xe,onClick:r=>ne(`${window.location.origin}/channels/${a}/${s}/${n.id_string}`)}))}function De({id:n,message:e}){return t.createElement("div",{className:`message ${e.__status__}`,"data-message-id":n,onContextMenu:a=>{window.appSetState({contextMenu:t.createElement(Be,{message:e,coordinates:[a.pageX,a.pageY]})}),a.preventDefault()}},t.createElement("span",{className:"message-content",dangerouslySetInnerHTML:{__html:ce.sanitize(S.render(e.content))}}))}function ae({author:n,children:e}){if(e instanceof Array||(e=[e]),e.length<1)throw new TypeError("message group must contain at least one message");const a=Le(Me(e[0].props.id));return t.createElement("div",{className:"message-container","data-author-id":n.id_string},t.createElement("div",{className:"message-avatar"},n.avatar?t.createElement("img",{src:n.avatar}):void 0),t.createElement("div",{className:"message-display"},t.createElement("div",{className:"message-heading"},t.createElement("span",{className:"message-author"},n.name),t.createElement("span",{className:"message-timestamp"},a)),e))}const Oe=BigInt("16602069666338596454400000");function Fe(n){if(n=n.sort((i,l)=>BigInt(i.id_string)-BigInt(l.id_string)>0?1:-1),!n.length)return[];let e,a,s=[],r=[];for(const i of n)a=t.createElement(De,{id:i.id_string,message:i,key:i.id_string}),!(e==null?void 0:e.author_id_string)||i.author_id_string===e.author_id_string&&BigInt(i.id_string)-BigInt(e.id_string)<Oe?s.push(a):(r.push(t.createElement(ae,{author:e.author,key:s[0].props.id+":"+s.length},s)),s=[a]),e=i;return r.push(t.createElement(ae,{author:e.author,key:s[0].props.id+":"+s.length},s)),r.reverse()}class Re extends t.Component{constructor(e){super(e);o(this,"_keepLoading");o(this,"_historyOffset");window.updateChat=this.forceUpdate.bind(this),this.messages.push=(...a)=>{Array.prototype.push.apply(this.messages,a),this.forceUpdate()},this.state={_:this.messages},this.onKeyPress=this.onKeyPress.bind(this),this.onScroll=this.onScroll.bind(this),window.api.loadedChannels.includes(this.props.channelId)||this.loadHistory(),this._keepLoading=!0,this._historyOffset=0}get messages(){return window.api.messages.has(this.props.channelId)||window.api.messages.set(this.props.channelId,[]),window.api.messages.get(this.props.channelId)}async loadHistory(e=200,a=0){const s={limit:e,offset:a,oldest_first:!1},r=await window.api.rest.request("GET",`/channels/${this.props.channelId}/messages`,{params:s});window.api.loadedChannels.push(this.props.channelId),r.messages.length<e&&(this._keepLoading=!1),this.messages.splice(0,0,...r.messages.map(i=>(i.author.avatar=N,i))),this.forceUpdate()}onKeyPress(e){var a,s;if(!e.shiftKey&&e.key==="Enter"){e.preventDefault();let r=document.getElementById("chat-input-textarea");const i=r.innerText.trim();if(!i)return;const l=Ae().toString(),d={id:0,id_string:l,author_id:0,author_id_string:(a=window.api)==null?void 0:a.userId,author:(s=window.api)==null?void 0:s.user,channel_id:0,channel_id_string:this.props.channelId,content:i,__status__:"pending"};this.messages.push(d),window.api.nonces.set(l,d),this.forceUpdate(),window.api.rest.request("POST",`/channels/${this.props.channelId}/messages`,{json:{content:i,nonce:l}}).catch(m=>{d.__status__="error",window.updateChat()}),r.innerHTML=""}}onScroll(e){if(!this._keepLoading)return;e.currentTarget.scrollHeight+e.currentTarget.scrollTop-e.currentTarget.offsetHeight<10&&(this._historyOffset+=200,this.loadHistory(200,this._historyOffset))}render(){return t.createElement("div",{id:"chat"},t.createElement("div",{className:"chat-items"},t.createElement("div",{className:"chat-messages",onScroll:this.onScroll},Fe(this.state._)),t.createElement("div",{className:"chat-input-container"},t.createElement("div",{className:"chat-input"},t.createElement("div",{id:"chat-input-textarea",contentEditable:"true",placeholder:"Send a message...",spellCheck:"false",onKeyPress:this.onKeyPress})))))}}function qe(){const{guildId:n,channelId:e}=g(),a=window.api.guilds.find(r=>r.id_string==n);return a||v()("/home"),a.channels.find(r=>r.id_string==e)||v()("/home"),t.createElement(X,null,t.createElement(Re,{channelId:e,key:e}))}function je(){const{guildId:n}=g(),e=window.api.guilds.find(a=>a.id_string==n);return e||v()("/home"),t.createElement(X,null,t.createElement("div",{className:"generic-message"},t.createElement("h1",null,"Welcome to ",t.createElement("b",null,e.name),"!"),t.createElement("p",null,"You may use the channel sidebar on the left to navigate this server.")))}function R({label:n,path:e}){const a=window.location.pathname.endsWith("/"+e)?"settings-button active":"settings-button";return t.createElement(b,{className:a,to:`/settings/${e}`},n)}function re({name:n}){return t.createElement("div",{className:"section-name"},n)}function He(){return t.createElement("div",{className:"settings-select"},t.createElement("div",{className:"settings-buttons"},t.createElement(re,{name:"Account"}),t.createElement(R,{label:"Account",path:"account"}),t.createElement(re,{name:"Appearance"}),t.createElement(R,{label:"Theme",path:"theme"}),t.createElement(R,{label:"Chat",path:"chat"})),t.createElement("br",null),t.createElement(b,{className:"settings-button settings-back-button",to:"/"},"Back"))}function se({children:n}){return t.createElement("div",{className:"app-content"},t.createElement(He,null),t.createElement("div",{className:"main"},n))}function Ke(){return t.createElement(se,null,t.createElement("div",{className:"account-settings-tag"},t.createElement("span",{className:"username"},window.api.user.name),t.createElement("span",{className:"discriminator"},"#",window.api.user.discriminator.toString().padStart(4,"0"))),t.createElement("div",{className:"account-settings-buttons"},t.createElement(f,{style:h.success,label:"Verify Account",onClick:()=>{window.api.rest.request("POST","/verify",{json:{}}).then(n=>alert("Sent a verification link to the email accosiated with this account."))}}),t.createElement(f,{style:h.danger,label:"Log Out",onClick:()=>{p.remove("token"),window.location.pathname="/login"}}),t.createElement(f,{style:h.danger,label:"Delete Account",onClick:()=>{window.api.rest.request("DELETE",`/users/${window.api.userId}`).then(()=>{p.remove("token"),window.location.pathname="/login"})}})))}function q({label:n,name:e,description:a}){return t.createElement("div",{className:"preset-theme",onClick:()=>window.themeManager.putPresetTheme(e)},t.createElement("div",{className:"preset-theme-label"},n),t.createElement("div",{className:"preset-theme-description"},a))}function c({label:n,name:e}){const a=r=>{window.themeManager.theme[e]=r.target.value,window.themeManager.updateThemeFor(e)};let s=window.themeManager.theme[e];return t.createElement("div",{className:"custom-theme-picker"},t.createElement("input",{type:"color",id:`custom-theme-picker__${e}`,name:e,value:s,onInput:a}),t.createElement("div",{className:"custom-theme-picker-color",id:`custom-theme-picker-color__${e}`,onClick:()=>{var r;return(r=document.getElementById(`custom-theme-picker__${e}`))==null?void 0:r.click()},style:{backgroundColor:s}}),t.createElement("div",{className:"custom-theme-picker-content"},t.createElement("div",null,n),t.createElement("input",{id:`custom-theme-picker-text__${e}`,type:"text",placeholder:s,onChange:a})))}function Ge(){return t.createElement(se,null,t.createElement("div",{className:"themes"},t.createElement("h1",null,"Themes"),t.createElement("div",{className:"preset-themes"},t.createElement("h2",null,"Preset Themes"),t.createElement(q,{label:"Light",name:"light",description:"A light theme with bright, contrasted colors."}),t.createElement(q,{label:"Dark",name:"dark",description:"The default theme: A dark theme with moderately contrasted colors."}),t.createElement(q,{label:"Midnight",name:"midnight",description:"A pitch, pure black theme with contrast in text. Darker than dark mode."})),t.createElement("div",{className:"custom-theme"},t.createElement("h2",null,"Custom Theme"),t.createElement("div",{className:"custom-theme-pickers"},t.createElement(c,{label:"Background (Primary)",name:"dark"}),t.createElement(c,{label:"Background (Secondary/Chat)",name:"darker"}),t.createElement(c,{label:"Background (Tertiary)",name:"darkest"}),t.createElement(c,{label:"Background (Quaternary)",name:"pitch"}),t.createElement(c,{label:"Generic (Primary)",name:"primary"}),t.createElement(c,{label:"Generic (Secondary)",name:"secondary"}),t.createElement(c,{label:"Text/Foreground",name:"text"}),t.createElement(c,{label:"Text/Foreground (Error)",name:"error"}),t.createElement(c,{label:"Link",name:"link"}),t.createElement(c,{label:"Link (Hover)",name:"link-hover"}),t.createElement(c,{label:"Scrollbar Thumb",name:"scrollbar-front"}),t.createElement(c,{label:"Scrollbar Thumb (Hover)",name:"scrollbar-front-hover"}),t.createElement(c,{label:"Scrollbar Track",name:"scrollbar-back"}),t.createElement(c,{label:"Button (Primary)",name:"button-primary"}),t.createElement(c,{label:"Button (Secondary)",name:"button-secondary"}),t.createElement(c,{label:"Button (Success)",name:"button-success"}),t.createElement(c,{label:"Button (Danger)",name:"button-danger"})),t.createElement(f,{style:h.success,label:"Save",onClick:()=>{p.set("theme",JSON.stringify(window.themeManager.theme))}}))))}class Je extends t.Component{constructor(e){super(e);window.api=e.api,window._resolver(e.api),window.appSetState=this.setState.bind(this),document.addEventListener("click",()=>this.setState({contextMenu:void 0})),this.state={contextMenu:void 0}}render(){return t.createElement(t.Fragment,null,this.state.contextMenu,t.createElement(U,null,t.createElement(z,null,t.createElement(u,{path:"/home",element:t.createElement(ve,null)}),t.createElement(u,{path:"/channels/:guildId/:channelId",element:t.createElement(qe,null)}),t.createElement(u,{path:"/channels/:guildId",element:t.createElement(je,null)}),t.createElement(u,{path:"/settings/account",element:t.createElement(Ke,null)}),t.createElement(u,{path:"/settings/theme",element:t.createElement(Ge,null)}),t.createElement(u,{path:"/settings/*",element:t.createElement(P,{to:"/settings/account"})}),t.createElement(u,{path:"*",element:t.createElement(P,{to:"/home"})}))))}}const Ue="#d1d1d1",ze="#dddddd",We="#eeeeee",Ye="#ffffff",Ve="#79bee0",Xe="#53afbd",Ze="#000000",Qe="#36c9f7",et="rgb(223, 67, 67)";var tt={pitch:Ue,darkest:ze,darker:We,dark:Ye,primary:Ve,secondary:Xe,text:Ze,link:Qe,"link-hover":"#13aad8",error:et,"scrollbar-front":"rgba(0, 0, 0, 0.07)","scrollbar-front-hover":"rgba(0, 0, 0, 0.15)","scrollbar-back":"#ffffff","button-primary":"#629bb8","button-secondary":"rgb(132, 141, 146)","button-success":"#59e487","button-danger":"rgb(240, 78, 78)"};const nt="#0a0b0b",at="#23231a",rt="#292e30",st="#35393b",it="#629bb8",ot="4597a3",lt="#ffffff",ct="#74dfff",mt="rgb(240, 107, 107)";var dt={pitch:nt,darkest:at,darker:rt,dark:st,primary:it,secondary:ot,text:lt,link:ct,"link-hover":"#10c7ff",error:mt,"scrollbar-front":"rgba(255, 255, 255, 0.07)","scrollbar-front-hover":"rgba(255, 255, 255, 0.15)","scrollbar-back":"#35393b","button-primary":"#629bb8","button-secondary":"rgb(132, 141, 146)","button-success":"#4fbf74","button-danger":"rgb(240, 78, 78)"};const ut="#000000",ht="#161616",pt="#1a1a1a",gt="#313131",ft="#629bb8",Et="4597a3",wt="#ffffff",bt="#74dfff",vt="rgb(240, 107, 107)";var yt={pitch:ut,darkest:ht,darker:pt,dark:gt,primary:ft,secondary:Et,text:wt,link:bt,"link-hover":"#10c7ff",error:vt,"scrollbar-front":"rgba(255, 255, 255, 0.07)","scrollbar-front-hover":"rgba(255, 255, 255, 0.15)","scrollbar-back":"#313131","button-primary":"#629bb8","button-secondary":"rgb(132, 141, 146)","button-success":"#4fbf74","button-danger":"rgb(240, 78, 78)"};const ie={light:tt,dark:dt,midnight:yt};class _t{constructor(){o(this,"theme");o(this,"themeName");o(this,"_selector");this._selector=document.querySelector(":root"),this.resolveTheme()}resolveTheme(){const e=p.get("theme")||"preset:dark";e.startsWith("preset:")?this.theme=Object.assign({},ie[this.themeName=e.slice(7).toLowerCase()]):this.theme=JSON.parse(e),this.updateTheme()}updateElements(e,a){const s=document.getElementById(`custom-theme-picker__${e}`);s&&(s.value=a);const r=document.getElementById(`custom-theme-picker-color__${e}`);r&&(r.style.backgroundColor=a);const i=document.getElementById(`custom-theme-picker-text__${e}`);i&&(i.value=a)}updateTheme(){for(const[e,a]of Object.entries(this.theme))this._selector.style.setProperty("--"+e,a),this.updateElements(e,a)}updateThemeFor(e){this._selector.style.setProperty("--"+e,this.theme[e]),this.updateElements(e,this.theme[e])}putPresetTheme(e){const a=Object.assign({},ie[e=e.toLowerCase()]);!a||(p.set("theme","preset:"+(this.themeName=e)),this.theme=a,this.updateTheme())}}var kt="/assets/ferris.f3dddc69.png";K.setAppElement("#app");window.themeManager=new _t;window._apiPromise=new Promise(n=>window._resolver=n);window.waitForAPI=async()=>await window._apiPromise;window.showLoading=()=>{M.render(t.createElement("div",{className:"loading-screen"},t.createElement("img",{src:kt,alt:"Ferris"}),t.createElement("h2",null,"Loading...")),document.getElementById("app"))};window.startApp=()=>{window.showLoading(),window.waitForAPI().then(n=>n.waitForReady().then(e=>M.render(t.createElement(Je,{api:e}),document.getElementById("app"))))};const Nt="Don't paste anything into this console without knowing what you're doing first. Your account could get compromised!";console.log("%c"+Nt,"font-size:23px;");const oe=p.get("token");oe?(window.startApp(),window.api=D.fromToken(oe)):M.render(t.createElement(U,null,t.createElement(z,null,t.createElement(u,{path:"/login",element:t.createElement(ue,null)}),t.createElement(u,{path:"/register",element:t.createElement(he,null)}),t.createElement(u,{path:"*",element:t.createElement(P,{to:"/login"})}))),document.getElementById("app"));
